<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…Ø±Ø­Ù„Ù‡ Û± â€” Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ù†Ø¨Ø±Ø¯ Ø¹Ù†Ø§ØµØ±</title>
<style>
  :root{
    --bg1:#0b0f14; --bg2:#0e141b; --card:#ffffff12; --accent:#4fd6ff;
    --good:#2ecc71; --bad:#ff4b4b;
  }
  body{
    margin:0; padding:22px; font-family: Vazirmatn, system-ui, sans-serif;
    background: linear-gradient(180deg,var(--bg1),var(--bg2));
    color:#e6edf3; text-align:center;
  }
  h1{ margin:6px 0 12px; font-size:20px; }

  /* score */
  #scoreBox{ font-size:18px; margin-bottom:12px; color:#9be7ff; display:inline-block; }
  .score-change{ display:inline-block; margin-left:12px; padding:6px 10px; border-radius:10px; font-weight:700; opacity:0; transform:scale(.8); transition:all .28s ease; }
  .score-change.show{ opacity:1; transform:scale(1); }
  .score-change.plus{ background: rgba(46,204,113,0.95); color:#021; }
  .score-change.minus{ background: rgba(231,76,60,0.95); color:#fff; }

  .sets-container{ display:flex; gap:18px; justify-content:center; margin:18px 0; flex-wrap:wrap; }
  .set-box{
    min-width:220px; padding:16px; border-radius:14px; border:2px solid rgba(255,255,255,0.06);
    background: rgba(255,255,255,0.03); text-align:center; position:relative; overflow:hidden;
  }
  .set-title{ font-weight:700; margin-bottom:8px; }

  /* scanner vertical */
  .set-box::after{
    content:""; position:absolute; left:0; top:-120%; width:100%; height:60%;
    background: linear-gradient(180deg, rgba(0,255,120,0) 0%, rgba(0,255,120,0.18) 50%, rgba(0,255,120,0) 100%);
    animation: scan 2.6s linear infinite; pointer-events:none;
  }
  @keyframes scan{ 0%{top:-120%} 100%{top:160%} }

  /* cards tray */
  .cards{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin:18px 0; }
  .card{
    background: var(--card); padding:12px 18px; border-radius:32px; cursor:grab; user-select:none;
    border:1px solid rgba(255,255,255,0.06); box-shadow:0 6px 18px rgba(0,0,0,0.45); font-size:20px; min-width:52px; text-align:center;
    transition: transform .12s ease;
  }
  .card:active{ cursor:grabbing; }
  .card.fadeOut{ opacity:0; transform:translateY(-8px); transition:all .22s ease; visibility:hidden; }

  /* placed style */
  .placed{ background: rgba(255,255,255,0.05); border-radius:10px; padding:8px 12px; display:inline-block; margin:6px 6px 0 0; cursor:grab; }
  .placed-anim{ animation: dropIn .36s cubic-bezier(.2,.9,.2,1); }
  @keyframes dropIn{ 0%{transform:translateY(-14px) scale(.85); opacity:0} 60%{transform:translateY(6px) scale(1.03); opacity:1} 100%{transform:none} }

  /* green glow when placed */
  @keyframes greenPulse { 0%{box-shadow:0 0 0 rgba(0,255,120,0)} 40%{box-shadow:0 0 22px rgba(0,255,120,0.9),0 0 34px rgba(0,255,120,0.45)} 100%{box-shadow:0 0 0 rgba(0,255,120,0)} }
  .card-green-glow{ animation: greenPulse .7s ease-out; border-color: rgba(0,255,120,0.9) !important; }

  /* shake */
  @keyframes shake{0%{transform:none}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-6px)}100%{transform:none}}
  .shake{ animation:shake .36s; }

  #message{ margin-top:18px; min-height:56px; font-size:16px; line-height:1.35; }
  .math-text{ direction:ltr; unicode-bidi:embed; display:block; font-weight:700; font-size:18px; color:var(--accent); margin-bottom:6px; }

  /* big warning overlay (for errors like ØªÚ©Ø±Ø§Ø±ÛŒ or not member) */
  #bigWarn{
    position:fixed; left:50%; top:46%; transform:translate(-50%,-50%); z-index:9998;
    display:none; min-width:320px; background:rgba(10,10,10,0.9); padding:22px 28px; border-radius:12px;
    border:3px solid rgba(255,80,80,0.07); color: #fff; font-size:20px; text-align:center;
    box-shadow:0 12px 40px rgba(0,0,0,0.6);
  }
  #bigWarn .bigText{ font-size:22px; font-weight:800; margin-bottom:8px; color:var(--bad); }
  #bigWarn.small{ padding:12px 18px; font-size:16px; }

  /* end level overlay */
  #overlay{
    position:fixed; inset:0; display:none; z-index:9999;
    background: rgba(0,0,0,0.7); backdrop-filter: blur(4px);
    justify-content:center; align-items:center;
  }
  #endBox{
    background:#071020; padding:28px 36px; border-radius:16px; text-align:center;
    box-shadow:0 0 50px rgba(0,255,120,0.14);
    color:#e6edf3; min-width:320px;
  }
  #endBox h2{ font-size:22px; margin:6px 0 10px; }
  #endBox p{ color:#aee; margin:8px 0 12px; }

  .btn{ padding:10px 18px; border-radius:12px; font-size:16px; cursor:pointer; border:none; margin:6px; }
  .btn.yes{ background: #00e192; color:#022; }
  .btn.no{ background: #ff6b6b; color:#fff; }

  /* helpers */
  .hidden{ display:none !important; }
</style>
</head>
<body>
  <h1>Ù…Ø±Ø­Ù„Ù‡ Û± â€” Ø¢Ø²Ù…Ø§ÛŒØ´ Ø¹Ø¶ÙˆÛŒØª</h1>

  <!-- <<< Ø§ÛŒÙ† Ø¬Ù…Ù„Ù‡Ù” Ø¬Ø¯ÛŒØ¯ Ø¯Ù‚ÛŒÙ‚Ø§Ù‹ Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØª >>> -->
  <p id="introText" style="font-size:22px; margin-top:10px; color:#80ffd8; font-weight:bold; text-shadow:0 0 12px rgba(0,255,140,0.55);">
    Ù‚ÙˆØ§Ù†ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ Ù†ÙˆØ´ØªÙ‡ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯â€¦ Ø§Ú©Ù†ÙˆÙ† Ù†ÙˆØ¨Øª ØªÙˆØ³Øª Ú©Ø§Ø±ØªÙ Ù‚Ø¯Ø±Øª Ø±Ø§ Ø¯Ø± Ø¬Ø§ÛŒ Ø­Ù‚ÛŒÙ‚ÛŒâ€ŒØ§Ø´ Ø¨Ù†Ø´Ø§Ù†ÛŒ Ùˆ ØªØ¹Ø§Ø¯Ù„ Ø¹Ù†Ø§ØµØ± Ø±Ø§ Ø¨Ø±Ù‚Ø±Ø§Ø± Ú©Ù†ÛŒ.
  </p>

  <div id="scoreBox">Ø§Ù…ØªÛŒØ§Ø²: <span id="scoreVal">0</span>
    <span id="scoreChange" class="score-change"></span>
  </div>

  <div class="sets-container">
    <div class="set-box" data-set="A">
      <div class="set-title">A = { 1 , 3 , 5 }</div>
      <div class="set-contents" data-contents="A"></div>
    </div>

    <div class="set-box" data-set="B">
      <div class="set-title">B = { 3 , 4 , 5 }</div>
      <div class="set-contents" data-contents="B"></div>
    </div>

    <div class="set-box" data-set="C">
      <div class="set-title">C = { 2 , 5 , 6 }</div>
      <div class="set-contents" data-contents="C"></div>
    </div>
  </div>

  <div class="cards" id="tray">
    <!-- initial tray: 9 cards as requested -->
    <div class="card" draggable="true" id="tray-1" data-value="1">Û±</div>
    <div class="card" draggable="true" id="tray-2" data-value="2">Û²</div>
    <div class="card" draggable="true" id="tray-3" data-value="3">Û³</div>
    <div class="card" draggable="true" id="tray-4" data-value="3">Û³</div>
    <div class="card" draggable="true" id="tray-5" data-value="4">Û´</div>
    <div class="card" draggable="true" id="tray-6" data-value="5">Ûµ</div>
    <div class="card" draggable="true" id="tray-7" data-value="5">Ûµ</div>
    <div class="card" draggable="true" id="tray-8" data-value="5">Ûµ</div>
    <div class="card" draggable="true" id="tray-9" data-value="6">Û¶</div>
  </div>

  <div id="message"></div>
  <div id="bigWarn"><div class="bigText" id="bigWarnTitle"></div><div id="bigWarnSub"></div></div>

  <!-- end-level overlay -->
  <div id="overlay">
    <div id="endBox">
      <h2 id="endTitle">ğŸ‰ Ù…Ø±Ø­Ù„Ù‡ Û± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú©Ø§Ù…Ù„ Ø´Ø¯!</h2>
      <p id="endText">Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡ Û²ØŸ</p>
      <div>
        <button class="btn yes" id="btnNext">Ø¨Ø²Ù† Ø¨Ø±ÛŒÙ…</button>
        <button class="btn no" id="btnRetry">Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ù…ÛŒâ€ŒÚ©Ù†Ù…</button>
      </div>
    </div>
  </div>

<script>
/* ---------- data ---------- */
const sets = { A: [1,3,5], B: [3,4,5], C: [2,5,6] };
let score = 0;
const initialTrayCount = document.querySelectorAll('#tray .card').length;

/* elements */
const scoreVal = document.getElementById('scoreVal');
const scoreChange = document.getElementById('scoreChange');
const tray = document.getElementById('tray');
const boxes = document.querySelectorAll('.set-box');
const messageEl = document.getElementById('message');
const bigWarn = document.getElementById('bigWarn');
const bigWarnTitle = document.getElementById('bigWarnTitle');
const bigWarnSub = document.getElementById('bigWarnSub');
const overlay = document.getElementById('overlay');
const endTitle = document.getElementById('endTitle');
const endText = document.getElementById('endText');
const btnNext = document.getElementById('btnNext');
const btnRetry = document.getElementById('btnRetry');

/* state */
let placedCount = 0; // current number of placed cards across sets

/* helpers */
function updateScore(delta){
  score += delta;
  scoreVal.textContent = score;
  scoreChange.textContent = (delta>0? '+'+delta : delta);
  scoreChange.className = 'score-change ' + (delta>0? 'plus show' : 'minus show');
  setTimeout(()=> scoreChange.className = 'score-change', 700);
}

function setMessage(mathLine, persian){
  messageEl.innerHTML = `<span class="math-text" dir="ltr">${mathLine}</span><div style="margin-top:6px">${persian}</div>`;
}

/* big warning modal (for duplicate / wrong membership) */
function showBigWarn(title, sub='', duration=2000, shakeTarget=null){
  bigWarnTitle.textContent = title;
  bigWarnSub.textContent = sub;
  bigWarn.style.display = 'block';
  if(shakeTarget) { shakeTarget.classList.add('shake'); setTimeout(()=> shakeTarget.classList.remove('shake'), 450); }
  setTimeout(()=> bigWarn.style.display = 'none', duration);
}

/* create unique id */
function uniqueId(prefix='id'){ return prefix + '-' + Date.now() + '-' + Math.floor(Math.random()*1000); }

/* add green flash inside set box */
function addGreenFlash(box){
  const fx = document.createElement('div');
  fx.style.position='absolute'; fx.style.inset='0';
  fx.style.pointerEvents='none'; fx.style.borderRadius='12px';
  fx.style.boxShadow='inset 0 0 26px 8px rgba(0,255,120,0.85)';
  fx.style.opacity='0.98';
  box.appendChild(fx);
  setTimeout(()=> fx.style.opacity='0', 160);
  setTimeout(()=> fx.remove(), 420);
}

/* make tray card draggable */
function makeTrayCardDraggable(el){
  el.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('value', el.dataset.value);
    e.dataTransfer.setData('origin','tray');
    e.dataTransfer.setData('dragId', el.id);
    // hide visually but keep in DOM (we may remove later)
    el.classList.add('fadeOut');
    setTimeout(()=> el.style.visibility = 'hidden', 120);
  });

  // click to highlight (touch-friendly)
  el.addEventListener('click', ()=> {
    el.style.transform = 'scale(1.05)';
    setTimeout(()=> el.style.transform = '', 160);
  });
}

/* make placed card draggable & clickable to return */
function makePlacedDraggable(placedEl){
  placedEl.setAttribute('draggable','true');

  placedEl.addEventListener('dragstart', e=>{
    e.dataTransfer.setData('value', placedEl.dataset.value);
    e.dataTransfer.setData('origin','placed');
    e.dataTransfer.setData('dragId', placedEl.id);
    // record original parent id for revert
    const parentSet = placedEl.closest('.set-box')?.dataset?.set || '';
    e.dataTransfer.setData('fromSet', parentSet);
    // hide while dragging
    placedEl.classList.add('fadeOut');
    setTimeout(()=> placedEl.style.visibility = 'hidden', 140);
  });

  // clicking a placed card returns it to tray (fast UX)
  placedEl.addEventListener('click', ()=>{
    returnPlacedToTray(placedEl);
  });
}

/* return placed element back to tray (used on click or drop to tray) */
function returnPlacedToTray(placedEl){
  const val = Number(placedEl.dataset.value);
  // remove placedEl
  placedEl.remove();
  placedCount = Math.max(0, placedCount - 1);

  // recreate tray card
  const newId = uniqueId('tray');
  const card = document.createElement('div');
  card.className = 'card';
  card.id = newId;
  card.dataset.value = val;
  card.draggable = true;
  card.textContent = val;
  makeTrayCardDraggable(card);
  tray.appendChild(card);

  // NOTE: per request, do NOT show "Ú©Ø§Ø±Øª Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø³ÛŒÙ†ÛŒ." message here
}

/* drop handlers for set boxes */
boxes.forEach(box => {
  box.addEventListener('dragover', e => e.preventDefault());

  box.addEventListener('drop', e => {
    e.preventDefault();
    const value = Number(e.dataTransfer.getData('value'));
    const origin = e.dataTransfer.getData('origin'); // 'tray' or 'placed'
    const dragId = e.dataTransfer.getData('dragId');
    const fromSet = e.dataTransfer.getData('fromSet'); // if placed
    handleDropToSet({value, origin, dragId, fromSet}, box);
  });
});

/* tray drop: allow returning placed items by dropping to tray */
tray.addEventListener('dragover', e => e.preventDefault());
tray.addEventListener('drop', e => {
  e.preventDefault();
  const origin = e.dataTransfer.getData('origin');
  const dragId = e.dataTransfer.getData('dragId');
  const value = Number(e.dataTransfer.getData('value'));

  if(origin === 'placed'){
    const placedEl = document.getElementById(dragId);
    if(placedEl){
      // remove placed and recreate tray card
      placedEl.remove();
      placedCount = Math.max(0, placedCount - 1);
      const newId = uniqueId('tray');
      const card = document.createElement('div');
      card.className = 'card';
      card.id = newId;
      card.dataset.value = value;
      card.draggable = true;
      card.textContent = value;
      makeTrayCardDraggable(card);
      tray.appendChild(card);
      // NOTE: per request, do NOT show "Ú©Ø§Ø±Øª Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø³ÛŒÙ†ÛŒ." message here
    }
  } else if(origin === 'tray'){
    // restore hidden tray card if user canceled dropping
    const el = document.getElementById(dragId);
    if(el){ el.style.visibility = 'visible'; el.classList.remove('fadeOut'); }
  }
});

function handleDropToSet(drag, box){
  const setName = box.dataset.set;
  const contentsEl = box.querySelector('.set-contents');
  const existing = Array.from(contentsEl.querySelectorAll('.placed')).map(d => Number(d.dataset.value));
  const value = Number(drag.value);

  // if origin was placed (moving between sets)
  if(drag.origin === 'placed'){
    const orig = document.getElementById(drag.dragId);
    if(!orig){
      // nothing to move
      return;
    }
    const fromSet = drag.fromSet || orig.closest('.set-box')?.dataset?.set;
    // if dropping into same set -> just restore visibility
    if(fromSet === setName){
      orig.style.visibility = 'visible'; orig.classList.remove('fadeOut');
      setMessage(`${value} âˆˆ ${setName}`, `${value} Ø¹Ø¶Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ø§Ø³Øª (Ù‡Ù…Ø§Ù†â€ŒØ¬Ø§).`);
      return;
    }
    // duplicate check in target
    if(existing.includes(value)){
      showBigWarn('Ø§ÛŒÙ† Ø¹Ø¯Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ Ø§Ø³Øª', `Ø¹Ø¯Ø¯ ${value} Ù‚Ø¨Ù„Ø§Ù‹ Ø¯Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡.`, 2000, box);
      // restore to original parent (orig)
      orig.style.visibility = 'visible'; orig.classList.remove('fadeOut');
      return;
    }
    // membership check: if value not in set's definition -> not allowed
    if(!sets[setName].includes(value)){
      showBigWarn('Ø¯Ù‚Øª Ú©Ù†! Ø§ÛŒÙ† Ø¹Ø¶Ùˆ Ø¯Ø§Ø®Ù„ Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù†ÛŒØ³Øª', `Ø¹Ø¯Ø¯ ${value} Ø¹Ø¶Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ù†ÛŒØ³Øª.`, 2000, box);
      orig.style.visibility = 'visible'; orig.classList.remove('fadeOut');
      return;
    }
    // allowed: move element from old parent to new
    orig.remove(); // detach from old parent
    contentsEl.appendChild(orig);
    orig.classList.remove('fadeOut');
    orig.classList.add('placed-anim');
    setTimeout(()=> orig.classList.remove('placed-anim'), 420);
    setMessage(`${value} âˆˆ ${setName}`, `${value} Ø­Ø§Ù„Ø§ Ø¹Ø¶Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ø§Ø³Øª.`);
    addGreenFlash(box);
    return;
  }

  // origin is tray (placing fresh)
  // duplicate check
  if(existing.includes(value)){
    showBigWarn('Ø§ÛŒÙ† Ø¹Ø¯Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ Ø§Ø³Øª', `Ø¹Ø¯Ø¯ ${value} Ù‚Ø¨Ù„Ø§Ù‹ Ø¯Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡.`, 2000, box);
    updateScore(-10);
    // restore tray card visibility if it was hidden
    const trayCard = document.getElementById(drag.dragId);
    if(trayCard){ trayCard.style.visibility = 'visible'; trayCard.classList.remove('fadeOut'); }
    return;
  }

  // membership check
  if(!sets[setName].includes(value)){
    showBigWarn('Ø¯Ù‚Øª Ú©Ù†! Ø§ÛŒÙ† Ø¹Ø¶Ùˆ Ø¯Ø§Ø®Ù„ Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù†ÛŒØ³Øª', `Ø¹Ø¯Ø¯ ${value} Ø¹Ø¶Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ù†ÛŒØ³Øª.`, 2000, box);
    updateScore(-10);
    const trayCard = document.getElementById(drag.dragId);
    if(trayCard){ trayCard.style.visibility = 'visible'; trayCard.classList.remove('fadeOut'); }
    return;
  }

  // correct placement: create placed element inside this set, remove original tray card
  const placed = document.createElement('div');
  placed.className = 'placed placed-anim';
  placed.textContent = value;
  placed.dataset.value = value;
  placed.id = uniqueId('placed');

  makePlacedDraggable(placed);
  contentsEl.appendChild(placed);
  addGreenFlash(box);

  // remove original tray card (if exists)
  const trayCard = document.getElementById(drag.dragId);
  if(trayCard) trayCard.remove();

  placedCount++;
  updateScore(+10);
  setMessage(`${value} âˆˆ ${setName}`, `${value} Ø¹Ø¶Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ù‡Ù” ${setName} Ø§Ø³ØªØ› Ø¢ÙØ±ÛŒÙ†!`);

  // check end condition: all initial tray cards placed
  if(placedCount === initialTrayCount){
    // show end modal
    setTimeout(()=> showEndModal(), 420);
  }
}

/* show end modal */
function showEndModal(){
  overlay.style.display = 'flex';
  endTitle.textContent = 'ğŸ‰ Ù…Ø±Ø­Ù„Ù‡ Û± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú©Ø§Ù…Ù„ Ø´Ø¯!';
  endText.textContent = 'Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡Ù” Û²ØŸ';
}

/* nextLevel / retry buttons */
btnNext.addEventListener('click', ()=> {
  // placeholder: go to next level (now just hide modal and show a message)
  overlay.style.display = 'none';
  setMessage('Ø´Ø±ÙˆØ¹ Ù…Ø±Ø­Ù„Ù‡Ù” Û²', 'Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ù…Ø±Ø­Ù„Ù‡Ù” Û² Ø³Ø§Ø®ØªÙ‡ Ù†Ø´Ø¯Ù‡ â€” Ø¨Ø¹Ø¯Ø§Ù‹ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†.');
});
btnRetry.addEventListener('click', ()=> {
  overlay.style.display = 'none';
  // reset stage: remove all placed and restore tray as initial
  resetStage();
});

/* reset stage */
function resetStage(){
  // remove all placed
  document.querySelectorAll('.placed').forEach(el=> el.remove());
  // clear trays and recreate initial 9 cards
  tray.innerHTML = '';
  const initialValues = [1,2,3,3,4,5,5,5,6];
  initialValues.forEach((v,i)=>{
    const id = 'tray-' + (i+1);
    const card = document.createElement('div');
    card.className = 'card';
    card.id = id;
    card.dataset.value = v;
    card.draggable = true;
    card.textContent = v;
    makeTrayCardDraggable(card);
    tray.appendChild(card);
  });
  placedCount = 0;
  score = 0;
  scoreVal.textContent = score;
  setMessage('', '');
}

/* create initial draggable behaviour for existing tray cards */
document.querySelectorAll('#tray .card').forEach(el => makeTrayCardDraggable(el));

/* safety: if user cancels drop (dragend), restore hidden tray card visibility */
document.addEventListener('dragend', e=>{
  try{
    const dragId = e.dataTransfer?.getData?.('dragId') || null;
    if(dragId){
      const el = document.getElementById(dragId);
      if(el && el.classList.contains('fadeOut')){
        el.style.visibility = 'visible';
        el.classList.remove('fadeOut');
      }
    }
  }catch(err){
    // some browsers clear dataTransfer on dragend; ignore
  }
});

/* handle pressing Esc to close end modal */
document.addEventListener('keydown', e=>{
  if(e.key === 'Escape'){ overlay.style.display = 'none'; }
});

/* init message */
setMessage('Ù‡Ø¯Ù: Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯Ù† Ø§Ø¹Ø¶Ø§ÛŒ Ø¯Ø±Ø³Øª Ø¯Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§', 'Ù‡Ø± Ú©Ø§Ø±Øª Ø±Ø§ Ø¨Ú©Ø´ Ùˆ Ø±ÙˆÛŒ Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ø±Ù‡Ø§ Ú©Ù†.');
</script>
</body>
</html>
