<!doctype html>
<html lang="fa">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ù†Ø¨Ø±Ø¯ Ø¹Ù†Ø§ØµØ± â€” Ù†Ø³Ø®Ù‡ ÙˆØ¨</title>
  <style>
    :root{--bg:#0f172a;--card:#fff;--panel:#0b1220;--accent:#06b6d4}
    html,body{height:100%;margin:0;font-family:Tahoma,Arial,sans-serif;background:linear-gradient(180deg,#071429 0%, #07121b 100%);color:#e6eef8}
    .app{max-width:1000px;margin:18px auto;padding:18px}
    header{display:flex;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:0}
    .controls{display:flex;gap:8px;align-items:center}
    select,button{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:rgba(255,255,255,0.02);color:inherit}
    .stage-area{margin-top:14px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:12px;border-radius:12px}
    .top-row{display:flex;gap:12px;justify-content:space-between;align-items:flex-start}
    .island{flex:1;min-height:150px;border-radius:12px;padding:14px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));position:relative;display:flex;flex-direction:column;align-items:center}
    .island h3{margin:6px 0;font-size:16px}
    .dropzone{flex:1;width:100%;border-radius:10px;border:2px dashed rgba(255,255,255,0.04);display:flex;flex-wrap:wrap;gap:8px;padding:6px;align-content:flex-start;justify-content:center}
    .card{width:64px;height:40px;background:var(--card);color:#000;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:600;cursor:grab;box-shadow:0 6px 18px rgba(0,0,0,0.45)}
    .card.dragging{opacity:0.6;transform:scale(1.05)}
    .bottom-row{margin-top:14px;display:flex;gap:12px}
    .tray{flex:1;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:12px;border-radius:10px;min-height:120px}
    .tray .cards{display:flex;flex-wrap:wrap;gap:8px;justify-content:center}
    .hud{margin-top:12px;display:flex;gap:12px;align-items:center}
    .badge{background:rgba(255,255,255,0.03);padding:8px;border-radius:8px}
    .message{margin-left:auto;background:linear-gradient(90deg,var(--accent),#7c3aed);padding:8px 12px;border-radius:10px;color:#042b2f}
    .venn{position:relative;height:150px}
    .venn .left,.venn .right{position:absolute;top:20px;width:45%;height:110px;border-radius:50%;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center}
    .venn .left{left:5%}
    .venn .right{right:5%}
    .venn .center{position:absolute;left:27%;top:30px;width:46%;height:90px;border-radius:50%;pointer-events:none}
    .small{font-size:12px;color:#bcd}
    footer{margin-top:14px;font-size:13px;color:#9fb}
    @media(max-width:700px){.top-row{flex-direction:column}.island{min-height:120px}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ù†Ø¨Ø±Ø¯ Ø¹Ù†Ø§ØµØ± â€” Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ø¬Ø§Ø²ÛŒ (Ù¾Ø§ÛŒÙ‡ Û¹)</h1>
      <div class="controls">
        <label class="small">Ù…Ø±Ø­Ù„Ù‡:</label>
        <select id="levelSelect">
          <option value="easy">Ø¢Ø³Ø§Ù† â€” Ø¹Ø¶Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ù‡</option>
          <option value="medium">Ù…ØªÙˆØ³Ø· â€” Ø§Ø¬ØªÙ…Ø§Ø¹ / Ø§Ø´ØªØ±Ø§Ú©</option>
          <option value="hard">Ø³Ø®Øª â€” ØªÙØ§Ø¶Ù„</option>
        </select>
        <button id="resetBtn">Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ù…Ø±Ø­Ù„Ù‡</button>
        <button id="showAnswer">Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§Ø³Ø®</button>
      </div>
    </header>

    <section class="stage-area">
      <div class="top-row" id="topRow">
        <!-- islands injected here -->
      </div>

      <div class="hud">
        <div class="badge">Ø§Ù…ØªÛŒØ§Ø²: <span id="score">0</span></div>
        <div class="badge">Ø§Ø´ØªØ¨Ø§Ù‡: <span id="mistakes">0</span></div>
        <div class="message" id="hint">Ø¨Ø§ Ú©Ø´ÛŒØ¯Ù† Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¬Ø²ÛŒØ±Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ù†Ø¸Ù… Ø¨Ø¯Ù‡</div>
      </div>

      <div class="bottom-row">
        <div class="tray">
          <h4>Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§</h4>
          <div class="cards" id="cardsTray"></div>
        </div>
        <div style="width:240px;">
          <h4>Ø±Ø§Ù‡Ù†Ù…Ø§</h4>
          <div class="small" id="instructions"></div>
          <div style="height:12px"></div>
          <div class="small">Ù¾Ø§Ø¯Ø§Ø´â€ŒÙ‡Ø§: Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø±Ø³Øª = +10ØŒ Ø§Ø´ØªØ¨Ø§Ù‡ = -5</div>
        </div>
      </div>

    </section>
    <footer>Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ Ù…ÙØ§Ù‡ÛŒÙ… Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒÙ‡Ø§ â€” Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒ Ù†Ø³Ø®Ù‡ React ÛŒØ§ Ù‚Ø§Ø¨Ù„ÛŒØª Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø¨ÛŒÙ†Ù…ØŒ Ø¨Ú¯Ùˆ.</footer>
  </div>

  <script>
    // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø§Ø­Ù„
    const LEVELS = {
      easy: {
        title: 'Ø¬Ø²ÛŒØ±Ù‡â€ŒÛŒ Ø§Ø¹Ø¯Ø§Ø¯ Ú¯Ù…Ø´Ø¯Ù‡',
        islands: [
          {id:'A',name:'Ø²ÙˆØ¬ (A)',hint:'A = {2,4,6,8}'},
          {id:'B',name:'ÙØ±Ø¯ (B)',hint:'B = {1,3,5,7}'}
        ],
        cards: [1,2,3,4,5,6,7,8],
        validator: (lvl,zoneId,card)=>{
          const A = [2,4,6,8], B=[1,3,5,7];
          if(zoneId==='A') return A.includes(card);
          if(zoneId==='B') return B.includes(card);
          return false;
        }
      },
      medium: {
        title: 'Ù†Ø¨Ø±Ø¯ Ø§Ø´ØªØ±Ø§Ú©â€ŒÙ‡Ø§',
        islands: [
          {id:'A',name:'Ø¢ØªØ´ (A)',hint:''},
          {id:'I',name:'Ø§Ø´ØªØ±Ø§Ú© (A âˆ© B)',hint:''},
          {id:'B',name:'Ø¨Ø§Ø¯ (B)',hint:''}
        ],
        cards: ['ğŸ”¥','ğŸŒ‹','â˜€ï¸','ğŸ’¨','ğŸŒªï¸','ğŸŒ«ï¸'],
        validator: (lvl,zoneId,card)=>{
          // A = {ğŸ”¥,ğŸŒ‹,â˜€ï¸,ğŸ’¨}  B = {ğŸ’¨,ğŸŒªï¸,ğŸŒ«ï¸,â˜€ï¸}
          const A = ['ğŸ”¥','ğŸŒ‹','â˜€ï¸','ğŸ’¨'];
          const B = ['ğŸ’¨','ğŸŒªï¸','ğŸŒ«ï¸','â˜€ï¸'];
          if(zoneId==='I') return A.includes(card) && B.includes(card); // intersection
          if(zoneId==='A') return A.includes(card) && !B.includes(card);
          if(zoneId==='B') return B.includes(card) && !A.includes(card);
          return false;
        }
      },
      hard: {
        title: 'ØªÙØ§Ø¶Ù„ Ø¯Ø± Ø³Ø±Ø²Ù…ÛŒÙ† Ø³Ø§ÛŒÙ‡â€ŒÙ‡Ø§',
        islands: [
          {id:'A',name:'Ø³Ø±Ø²Ù…ÛŒÙ† Ø§Ù„Ù (A)'},
          {id:'B',name:'Ø³Ø±Ø²Ù…ÛŒÙ† Ø¨ (B)'}
        ],
        cards: ['ğŸ‰','ğŸ','ğŸ¦','ğŸ¸','ğŸ¦…','ğŸ¦Š'],
        validator: (lvl,zoneId,card)=>{
          const A=['ğŸ‰','ğŸ','ğŸ¦','ğŸ¸'];
          const B=['ğŸ','ğŸ¸','ğŸ¦…','ğŸ¦Š'];
          if(zoneId==='A') return A.includes(card) && !B.includes(card);
          if(zoneId==='B') return B.includes(card) && !A.includes(card);
          return false;
        }
      }
    };

    // state
    let currentLevel='easy';
    let score=0,mistakes=0;

    const topRow = document.getElementById('topRow');
    const cardsTray = document.getElementById('cardsTray');
    const levelSelect = document.getElementById('levelSelect');
    const resetBtn = document.getElementById('resetBtn');
    const showAnswer = document.getElementById('showAnswer');
    const scoreEl = document.getElementById('score');
    const mistakesEl = document.getElementById('mistakes');
    const hintEl = document.getElementById('hint');
    const instructions = document.getElementById('instructions');

    levelSelect.addEventListener('change',()=>{
      currentLevel = levelSelect.value;
      initLevel();
    });
    resetBtn.addEventListener('click',initLevel);
    showAnswer.addEventListener('click',()=>{revealAnswers()});

    // drag & drop
    let dragData = null;

    function makeCardElement(content){
      const d = document.createElement('div');
      d.className='card';
      d.draggable=true;
      d.tabIndex=0;
      d.textContent = content;
      d.addEventListener('dragstart',e=>{
        dragData=content;
        d.classList.add('dragging');
        e.dataTransfer.setData('text/plain',String(content));
      });
      d.addEventListener('dragend',()=>{dragData=null;d.classList.remove('dragging');});
      return d;
    }

    function createDropZone(id,label){
      const wrap = document.createElement('div');
      wrap.className='island';
      const title = document.createElement('h3');
      title.textContent = label;
      const dz = document.createElement('div');
      dz.className='dropzone';
      dz.dataset.zone = id;
      dz.addEventListener('dragover',e=>{e.preventDefault();});
      dz.addEventListener('drop',e=>{
        e.preventDefault();
        const data = e.dataTransfer.getData('text/plain');
        handleDrop(dz.dataset.zone,data,dz);
      });
      wrap.appendChild(title);
      wrap.appendChild(dz);
      return wrap;
    }

    function shuffle(a){return a.slice().sort(()=>Math.random()-0.5)}

    function initLevel(){
      const level = LEVELS[currentLevel];
      topRow.innerHTML='';
      cardsTray.innerHTML='';
      score=0;mistakes=0;updateHUD();
      hintEl.textContent = level.title;
      instructions.innerHTML = getInstructionText(currentLevel);

      // create islands/dropzones
      if(currentLevel==='medium'){
        // make 3 panes: A, Intersection, B visually as venn-like
        const left = createDropZone('A','Ø¢ØªØ´ (A)');
        const center = createDropZone('I','Ø§Ø´ØªØ±Ø§Ú© (A âˆ© B)');
        const right = createDropZone('B','Ø¨Ø§Ø¯ (B)');
        left.style.flex='0 0 32%'; right.style.flex='0 0 32%'; center.style.flex='0 0 32%';
        topRow.appendChild(left);topRow.appendChild(center);topRow.appendChild(right);
      } else {
        LEVELS[currentLevel].islands.forEach(isle=>{
          const el = createDropZone(isle.id,isle.name||isle.id);
          topRow.appendChild(el);
        });
      }

      // create cards
      const items = shuffle(level.cards);
      items.forEach(it=>{
        const c = makeCardElement(it);
        cardsTray.appendChild(c);
      });

    }

    function handleDrop(zoneId,card,zoneEl){
      // remove card from tray (find first matching)
      const nodes = Array.from(cardsTray.querySelectorAll('.card'));
      const node = nodes.find(n=>String(n.textContent)===String(card));
      if(node){
        // validate
        const ok = LEVELS[currentLevel].validator(currentLevel,zoneId,card);
        if(ok){
          zoneEl.appendChild(node);
          node.draggable=false;
          node.style.cursor='default';
          score+=10;updateHUD();
          flash(zoneEl,true);
        } else {
          // wrong drop: shake and return
          mistakes+=1;score-=5;updateHUD();
          flash(zoneEl,false);
          // visual bounce
          node.animate([{transform:'translateY(0)'},{transform:'translateY(-12px)'},{transform:'translateY(0)'}],{duration:420})
        }
      }
      checkCompletion();
    }

    function flash(el,ok){
      const orig = el.style.boxShadow;
      el.style.transition='box-shadow 220ms';
      el.style.boxShadow = ok? '0 0 18px 4px rgba(6,182,212,0.14)' : '0 0 18px 4px rgba(255,32,32,0.12)';
      setTimeout(()=>{el.style.boxShadow=orig},450);
    }

    function updateHUD(){scoreEl.textContent=score;mistakesEl.textContent=mistakes}

    function checkCompletion(){
      const remaining = cardsTray.querySelectorAll('.card').length;
      if(remaining===0){
        hintEl.textContent = 'Ù…Ø±Ø­Ù„Ù‡ ØªÙ…Ø§Ù… Ø´Ø¯! Ø§Ù…ØªÛŒØ§Ø² Ù†Ù‡Ø§ÛŒÛŒ: '+score;
        // show venn for medium or summary for hard
        if(currentLevel==='medium') showVennSummary();
        if(currentLevel==='hard') showDiffSummary();
      }
    }

    function showVennSummary(){
      const area = document.createElement('div');
      area.className='venn';
      area.innerHTML = '<div class="left"></div><div class="right"></div><div class="center"></div>';
      const top = document.querySelector('.stage-area');
      top.appendChild(area);
      setTimeout(()=>{area.scrollIntoView({behavior:'smooth'})},200);
    }

    function showDiffSummary(){
      const m = document.createElement('div');
      m.style.marginTop='12px';
      m.className='small';
      m.textContent='Ù…Ø±ÙˆØ±: Ø§Ø¹Ø¶Ø§ÛŒ Ù…Ù†Ø­ØµØ±Ø¨Ù‡â€ŒÙØ±Ø¯ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡ (Aâˆ’B Ùˆ Bâˆ’A) Ù†Ø´Ø§Ù† Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯.';
      document.querySelector('.stage-area').appendChild(m);
    }

    function revealAnswers(){
      // move cards to the correct zones with a small delay
      const level = LEVELS[currentLevel];
      const allCards = Array.from(document.querySelectorAll('.card'));
      allCards.forEach(c=>{c.remove();});
      // rebuild tray but reveal sorted
      const correctA = [];
      const correctB = [];
      const correctI = [];
      level.cards.forEach(card=>{
        // find zone foreach
        const zones = (['A','B','I']);
        let placed=false;
        zones.forEach(z=>{
          if(!placed && level.validator(currentLevel,z,card)){
            if(z==='A') correctA.push(card);
            if(z==='B') correctB.push(card);
            if(z==='I') correctI.push(card);
            placed=true;
          }
        });
      });
      // place cards to zones
      if(currentLevel==='medium'){
        const a = document.querySelector('[data-zone="A"] .dropzone') || document.querySelector('[data-zone="A"]');
        const i = document.querySelector('[data-zone="I"] .dropzone') || document.querySelector('[data-zone="I"]');
        const b = document.querySelector('[data-zone="B"] .dropzone') || document.querySelector('[data-zone="B"]');
        correctA.forEach(x=>{a.appendChild(makeCardElement(x));});
        correctI.forEach(x=>{i.appendChild(makeCardElement(x));});
        correctB.forEach(x=>{b.appendChild(makeCardElement(x));});
      } else {
        // A and B
        const a = document.querySelector('[data-zone="A"] .dropzone') || document.querySelector('[data-zone="A"]');
        const b = document.querySelector('[data-zone="B"] .dropzone') || document.querySelector('[data-zone="B"]');
        correctA.forEach(x=>{a.appendChild(makeCardElement(x));});
        correctB.forEach(x=>{b.appendChild(makeCardElement(x));});
      }
      hintEl.textContent = 'Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯. Ø§Ø² Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙ„Ø§Ø´ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†.';
    }

    function getInstructionText(level){
      if(level==='easy') return 'Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø§Ø¹Ø¯Ø§Ø¯ Û± ØªØ§ Û¸ Ù‡Ø³ØªÙ†Ø¯: Ø§Ø¹Ø¯Ø§Ø¯ Ø²ÙˆØ¬ Ø±Ø§ Ø¨Ù‡ Ø¬Ø²ÛŒØ±Ù‡Ù” Ø²ÙˆØ¬ (A) Ùˆ Ø§Ø¹Ø¯Ø§Ø¯ ÙØ±Ø¯ Ø±Ø§ Ø¨Ù‡ Ø¬Ø²ÛŒØ±Ù‡Ù” ÙØ±Ø¯ (B) Ø¨Ú©Ø´.';
      if(level==='medium') return 'Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¹Ù†Ø§ØµØ± Ù‡Ø³ØªÙ†Ø¯: Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ Ù†Ø§Ø­ÛŒÙ‡Ù” A-onlyØŒ Ù†Ø§Ø­ÛŒÙ‡Ù” Ø§Ø´ØªØ±Ø§Ú© (A âˆ© B) ÛŒØ§ Ù†Ø§Ø­ÛŒÙ‡Ù” B-only Ø¨Ú©Ø´.';
      if(level==='hard') return 'Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø­ÛŒÙˆØ§Ù†Ø§ØªÙ†Ø¯: ÙÙ‚Ø· Ø§Ø¹Ø¶Ø§ÛŒ Ù…Ù†Ø­ØµØ±Ø¨Ù‡â€ŒÙØ±Ø¯ Ù‡Ø± Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø±Ø§ Ø¨Ù‡ Ø¬Ø²ÛŒØ±Ù‡Ù” Ù…Ø±Ø¨ÙˆØ·Ù‡ (Aâˆ’B ÛŒØ§ Bâˆ’A) Ø¨Ú©Ø´.';
      return '';
    }

    // initialize
    initLevel();
  </script>
</body>
</html>
